
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Sparse matrix types - XDiag Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#coordinate-coo-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="XDiag Documentation" class="md-header__button md-logo" aria-label="XDiag Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            XDiag Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sparse matrix types
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="XDiag Documentation" class="md-nav__button md-logo" aria-label="XDiag Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    XDiag Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarks
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#coordinate-coo-format" class="md-nav__link">
    <span class="md-ellipsis">
      Coordinate (COO) format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compressed-sparse-row-csr-format" class="md-nav__link">
    <span class="md-ellipsis">
      Compressed-sparse-row (CSR) format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compressed-sparse-column-csc-format" class="md-nav__link">
    <span class="md-ellipsis">
      Compressed-sparse-column (CSC) format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interfacing-with-other-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Interfacing with other libraries
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Sparse matrix types</h1>

<p>As opposed to dense matrices, there exist several distinct formats in which sparse matrices are stored. XDiag offers capabilities to create several common sparse matrix formats which can be applied for the provided iterative algorithms. An overview of common sparse matrix formats formats can also be found on <a href="https://en.wikipedia.org/wiki/Sparse_matrix">Wikipedia</a>, where also a detailed description and examples can be found. In the following we describe the three supported sparse matrix formats and how these are represented in the code.</p>
<h2 id="coordinate-coo-format">Coordinate (COO) format</h2>
<p>The coordinate format is a simple format which consists of two integer arrays <code>nrows</code> and <code>ncols</code> which store the row and column indices of the non-zero elements, and an additional array <code>data</code> storing the actual numerical matrix entries as a real or complex number. Within XDiag, we represent this format as a simple struct, without any class functionality. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">C++</label><label for="__tabbed_1_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">idx_t</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">coeff_t</span><span class="o">&gt;</span><span class="w"> </span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">COOMatrix</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">nrows</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of rows in the matrix</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">ncols</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of columns in the matrix</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row</span><span class="p">;</span><span class="w">    </span><span class="c1">// row indices</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">col</span><span class="p">;</span><span class="w">    </span><span class="c1">// column indices</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">coeff_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="c1">// data entries</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">i0</span><span class="p">;</span><span class="w">                </span><span class="c1">// zero index, either 0 or 1</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">ishermitian</span><span class="p">;</span><span class="w">        </span><span class="c1">// flag whether matrix is hermitian/symmetric</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">struct</span> <span class="kt">COOMatrix</span><span class="p">{</span><span class="kt">IdxT</span><span class="o">&lt;:</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">CoeffT</span><span class="o">&lt;:</span><span class="kt">Number</span><span class="p">}</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="n">nrows</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="n">ncols</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="n">row</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">col</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span><span class="w"> </span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="n">data</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">CoeffT</span><span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="n">i0</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="n">ishermitian</span><span class="o">::</span><span class="kt">Bool</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>Notice, that in addition to the three arrays <code>row</code>, <code>col</code> <code>data</code>, also the total number of rows <code>nrows</code> and columns <code>ncols</code> is stored. Also, the entry <code>i0</code> is used in XDiag to indicate whether the matrix is 0-indexed (<code>i0=0</code>) or 1-indexed (<code>i0=1</code>). Lastly, whenever a sparse matrix is created in XDiag the flag <code>ishermitian</code> is set, which indicates whether or not the matrix is Hermitian. </p>
<p>The COO format is simple to understand and can be created very efficiently using XDiag. The entries in the <code>row</code> and <code>col</code> arrays are not ordered in any specific manner. This format is a common format in many sparse matrix libraries to create more advances storage types. A disadvantage of this format is the memory overhead by storing both row and column indices, which can for example be reduces in the compressed-sparse-row (CSR) or compressed-sparse-column (CSC) formats. Also, typically implementations of matrix-vector multiplications are often not efficient for the COO format, due to a lack of locality in memory.</p>
<p>To create matrices in the COO format, the functions <a href="../coo_matrix/">coo_matrix</a> and <a href="../coo_matrix/">coo_matrix_32</a> can be used.</p>
<h2 id="compressed-sparse-row-csr-format">Compressed-sparse-row (CSR) format</h2>
<p>The CSR format compresses information about the indices, by only storing the column indices in an integer array <code>col</code> and a "pointer" array <code>rowptr</code> (simply an integer index) to the first element of each row. Finally, the coefficients of the matrix are then stored in an array called <code>data</code>. For a detailed explanation of the format we refer to <a href="https://en.wikipedia.org/wiki/Sparse_matrix">Wikipedia</a>. Within XDiag, CSR matrices are represented by simple structs without any additional functionality. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">C++</label><label for="__tabbed_2_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">idx_t</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">coeff_t</span><span class="o">&gt;</span><span class="w"> </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">CSRMatrix</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">nrows</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of rows in the matrix</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">ncols</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of columns in the matrix</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rowptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// pointer to elements of a row (size: nrows+1)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">col</span><span class="p">;</span><span class="w">    </span><span class="c1">// columns for each row consecutively</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">coeff_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="c1">// data entries each row consecutively</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">i0</span><span class="p">;</span><span class="w">                </span><span class="c1">// zero index, either 0 or 1</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">ishermitian</span><span class="p">;</span><span class="w">        </span><span class="c1">// flag whether matrix is hermitian/symmetric</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">struct</span> <span class="kt">CSRMatrix</span><span class="p">{</span><span class="kt">IdxT</span><span class="o">&lt;:</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">CoeffT</span><span class="o">&lt;:</span><span class="kt">Number</span><span class="p">}</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="n">nrows</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="n">ncols</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="n">rowptr</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="n">col</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span><span class="w"> </span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="n">data</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">CoeffT</span><span class="p">}</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="n">i0</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="n">ishermitian</span><span class="o">::</span><span class="kt">Bool</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>Again the entries <code>nrows</code> and <code>ncols</code> denote the number of rows and columns, <code>i0</code> denotes whether the matrix is 0-indexed or 1-indexed, and the flag <code>ishermitian</code> is <code>true</code> if the sparse matrix is Hermitian.</p>
<p>CSR matrices created by XDiag are sorted in the sense that subsequent column indices within each row are monotonically increasing. CSR matrices (as well as CSC matrices) use less memory than the corresponding matrix in the COO format, as the information about row indices is compressed. Importantly, CSR matrix-vector or matrix-matrix multiplications can be efficiently parallelized, which makes this format highly attractive. The internal iterative algorithms provide support only for the CSR format, since with COO and CSC format it is very difficult to achieve comparable parallel performance as with CSR matrices. </p>
<p>To create matrices in the CSR format, the functions <a href="../csr_matrix/">csr_matrix</a> and <a href="../csr_matrix/">csr_matrix_32</a> can be used.</p>
<h2 id="compressed-sparse-column-csc-format">Compressed-sparse-column (CSC) format</h2>
<p>The CSC format is similar to the CSR format, but with the role of columns and rows switched. Hence, there is an integer array <code>row</code> storing al the row indices and the <code>colptr</code> which stores the index of the first element in each column. The <code>data</code> array then again stores values of the matrix entries. A CSC-format matrix is represented by simple structs in XDiag:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">C++</label><label for="__tabbed_3_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">idx_t</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">coeff_t</span><span class="o">&gt;</span><span class="w"> </span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">CSCMatrix</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">nrows</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of rows in the matrix</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">ncols</span><span class="p">;</span><span class="w">             </span><span class="c1">// number of columns in the matrix</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">colptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// pointer to elements of a row (size: ncols+1)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">idx_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row</span><span class="p">;</span><span class="w">    </span><span class="c1">// columns for each row consecutively</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="n">arma</span><span class="o">::</span><span class="n">Col</span><span class="o">&lt;</span><span class="n">coeff_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="c1">// data entries each row consecutively</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="n">idx_t</span><span class="w"> </span><span class="n">i0</span><span class="p">;</span><span class="w">                </span><span class="c1">// zero index, either 0 or 1</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">ishermitian</span><span class="p">;</span><span class="w">        </span><span class="c1">// flag whether matrix is hermitian/symmetric</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="p">};</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">struct</span> <span class="kt">CSCMatrix</span><span class="p">{</span><span class="kt">IdxT</span><span class="o">&lt;:</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">CoeffT</span><span class="o">&lt;:</span><span class="kt">Number</span><span class="p">}</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="n">nrows</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="n">ncols</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="n">colptr</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span><span class="w"> </span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="n">row</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">IdxT</span><span class="p">}</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="n">data</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">CoeffT</span><span class="p">}</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="n">i0</span><span class="o">::</span><span class="kt">IdxT</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="n">ishermitian</span><span class="o">::</span><span class="kt">Bool</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>Again the entries <code>nrows</code> and <code>ncols</code> denote the number of rows and columns, <code>i0</code> denotes whether the matrix is 0-indexed or 1-indexed, and the flag <code>ishermitian</code> is <code>true</code> if the sparse matrix is Hermitian.</p>
<p>CSC matrices are the standard choice for storing sparse matrices, both in Julia and armadillo. While this format offers several advantages like fast-column access, parallelizations of matrix-vector multiplications are more difficult, see for example this <a href="https://discourse.julialang.org/t/csc-kills-the-prospect-of-multithreading-shouldnt-julia-use-csr/102491">discussion</a> on the Julia Discourse.</p>
<p>To create matrices in the CSC format, the functions <a href="../csc_matrix/">csc_matrix</a> and <a href="../csc_matrix/">csc_matrix_32</a> can be used.</p>
<h2 id="interfacing-with-other-libraries">Interfacing with other libraries</h2>
<p>The matrix formats provided by XDiag are very raw lacking advanced sparse matrix functionality, except that CSR matrices can be used in internal algorithms in XDiag. To have more advanced sparse matrix features we recommend using third party library. Here, we show how to convert an XDiag sparse matrix to some specific libraries. First, the following code shows how to create a <code>SparseMatrixCSC</code> in Julia, which is part of the Julia standard libary. The standard Julia sparse matrix is in the compressed-sparse-columns (CSC) format, which is why we use the <a href="../csc_matrix/">csc_matrix</a> function to create the proper data structure. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">using</span><span class="w"> </span><span class="n">SparseArrays</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">xmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">jmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SparseMatrixCSC</span><span class="p">(</span><span class="n">xmat</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span><span class="w"> </span><span class="n">xmat</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span><span class="w"> </span><span class="n">xmat</span><span class="o">.</span><span class="n">colptr</span><span class="p">,</span><span class="w"> </span><span class="n">xmat</span><span class="o">.</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="n">xmat</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
<p>Another library featuring sparse matrix capabilities that can be used right away in C++ is the armadillo library included with XDiag. In armadillo, sparse matrices are represented by the <code>arma::spmat</code> and <code>arma::cx_spmat</code> classes, which also implement a CSC format. The conversion between the XDiag CSC matrix and the <code>arma::spmat</code> can be done using the following code snippet.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">OpSum</span><span class="p">(</span><span class="n">ops</span><span class="p">),</span><span class="w"> </span><span class="n">block</span><span class="p">);</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">auto</span><span class="w"> </span><span class="n">colptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arma</span><span class="o">::</span><span class="n">conv_to</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">uvec</span><span class="o">&gt;::</span><span class="n">from</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">colptr</span><span class="p">);</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">auto</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arma</span><span class="o">::</span><span class="n">conv_to</span><span class="o">&lt;</span><span class="n">arma</span><span class="o">::</span><span class="n">uvec</span><span class="o">&gt;::</span><span class="n">from</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">row</span><span class="p">);</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">auto</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arma</span><span class="o">::</span><span class="n">sp_mat</span><span class="p">(</span><span class="n">colptr</span><span class="p">,</span><span class="w"> </span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">.</span><span class="n">nrows</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">.</span><span class="n">ncols</span><span class="p">);</span>
</code></pre></div>
<p>This is slightly more verbose, as compared to the Julia version, as the index type has to be casted from signed integer in XDiag (<code>int32_t</code> or <code>int64_t</code>) to an unsigned integer of type <code>arma::uword</code>. We do not provide template specializations for unsigned integers in XDiag, since this would quite significantly increase the compilation overhead. We adhere to the general programming recommendation to stick with one integer type (in XDiag <code>int64_t</code>) throughout the library.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>